(function(d){function j(a,b,h){var g={},a=d(a),c=d(window),k=d(document),i=a.width(),e=a.height(),f=b.margin||0;b.fitToViewport&&(i>c.width()-2*f&&(b=c.width()-2*f,e*=b/i,i=b),e>c.height()-2*f&&(b=c.height()-2*f,i*=b/e,e=b));g.top=Math.max(c.height()/2-e/2+k.scrollTop(),0);g.left=Math.max(c.width()/2-i/2+k.scrollLeft(),0);if(h||a.width()>=c.width||a.height()>=c.height)g.width=i,g.height=e;return g}function f(a,b){return d.extend({},d(a).offset(),{width:a.offsetWidth,height:a.offsetHeight,elementWidth:b.offsetWidth,
elementHeight:b.offsetHeight})}d.positionAt=function(a,b,h){var g,c,f,i=d(a),e={};"string"==typeof h?g=h:d.isPlainObject(h)&&(g=h.location,c=h);c=c||{};f=c.offsetLeft||0;h=c.offsetTop||0;g?(i.css({position:"absolute"}),e=d.positionAt.locations[g].call(b,a,c)):(a=d(window).scrollTop(),g=d(window).width(),b.currentTarget?(c=b.pageX,b=b.pageY):(b=d(b).offset(),c=b.left,b=b.top),c+i.outerWidth()+2*f>=g&&(c=g-i.width()-f),b+2*h<=a&&(b=a-2*h),e={top:b,left:c});e.top+=h;e.left+=f;return e};d.fn.positionAt=
function(a,b){return this.each(function(){d(this).css(d.positionAt(this,a,b))})};d.positionAt.locations={elementBottom:function(a){a=f(this,a);return{top:a.top+a.height,left:a.left+a.width/2-a.elementWidth/2}},elementTop:function(a){a=f(this,a);return{top:a.top-a.elementHeight,left:a.left+a.width/2-a.elementWidth/2}},elementLeft:function(a){a=f(this,a);return{top:a.top+a.height/2-a.elementHeight/2,left:a.left-a.elementWidth}},elementRight:function(a){a=f(this,a);return{top:a.top+a.height/2-a.elementHeight/
2,left:a.left+a.width}},center:function(a,b){return j.call(this,a,b)},magnify:function(a,b){return j.call(this,a,b,!0)}}})(jQuery);

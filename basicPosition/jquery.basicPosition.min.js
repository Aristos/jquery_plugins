(function(c){function l(a,b,d){var c=m(a),e=m(b),f=d.margin||10,g=c.height;a=c.width;!1!==d.constrain&&(c.width>e.width-2*f&&(d=e.width-2*f,g=d/c.width*c.height,a=d),c.height>e.height-2*f&&(d=e.height-2*f,a=d/c.height*c.width,g=d));console.log(a,g);d=g;return{width:a,height:d,top:Math.max(0,(b.height()-d)/2+b.scrollTop()),left:Math.max(0,(b.width()-a)/2+b.scrollLeft())}}function k(a,b){return c.extend({},c(a).offset(),{width:a.offsetWidth,height:a.offsetHeight,elementWidth:b.offsetWidth,elementHeight:b.offsetHeight})}
function m(a){var b=a.attr("style"),c;a.css({position:"absolute",visibility:"hidden",display:"block"});c={width:a.width(),height:a.height()};a.removeAttr("style").attr("style",b);return c}c.positionAt=function(a,b,d){var h,e,f,g=c(a),j={};b=b instanceof jQuery?b[0]:b;"string"==typeof d?h=d:c.isPlainObject(d)&&(h=d.location,e=d);e=e||{};f=e.offsetLeft||0;d=e.offsetTop||0;h?(g.css({position:"absolute"}),j=c.positionAt.locations[h].call(b,a,e)):(a=c(window).scrollTop(),h=c(window).width(),b.currentTarget?
(e=b.pageX,b=b.pageY):(b=c(b).offset(),e=b.left,b=b.top),e+g.outerWidth()+2*f>=h&&(e=h-g.width()-f),b+2*d<=a&&(b=a-2*d),j={top:b,left:e});j.top+=d;j.left+=f;return j};c.fn.positionAt=function(a,b){return this.each(function(){c(this).css(c.positionAt(this,a,b))})};c.positionAt.locations={elementBottom:function(a){a=k(this,a);return{top:a.top+a.height,left:a.left+a.width/2-a.elementWidth/2}},elementTop:function(a){a=k(this,a);return{top:a.top-a.elementHeight,left:a.left+a.width/2-a.elementWidth/2}},
elementLeft:function(a){a=k(this,a);return{top:a.top+a.height/2-a.elementHeight/2,left:a.left-a.elementWidth}},elementRight:function(a){a=k(this,a);return{top:a.top+a.height/2-a.elementHeight/2,left:a.left+a.width}},center:function(a,b){return l(c(a),c(this),b)},centerParent:function(a,b){return l(c(a),c(this),b)},centerViewport:function(a,b){return l(c(a),c(window),b)}}})(jQuery);

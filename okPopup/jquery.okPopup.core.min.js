(function(c){function f(b){function a(a,d){d=c.isArray(d)?d:[d];b[a+"Effect"]=d.shift();b[a+"EffectOptions"]=d}a("open",b.openEffect);a("close",b.closeEffect);return b}c.fn.okPopup=function(b){return c.okPopup.create(this,b)};c.okPopup={create:function(b,a){a=c.extend({openEvent:null,closeEvent:null,openEffect:"show",closeEffect:"hide",onOpen:function(a,b){b.open(a)},onClose:function(a,b){b.close()},modal:!1,parent:"body",template:"<div class='ui-popup'></div>",overlayClass:"ui-overlay"},a.ui?c.okPopup.ui[a.ui].call(b,
a):null,a);var e,d;a.modal&&(d=c("."+a.overlayClass),0===d.length&&(d=c("<div id='ui-overlay' class='"+a.overlayClass+"' ></div>").appendTo("body").hide()));e=c("function"==typeof a.template?a.template.call(b):a.template).appendTo(a.parent).hide().extend({open:function(a,b){return c.okPopup.open.call(this,a,b)},close:function(){return c.okPopup.close.call(this)},overlay:d,options:f(a)});if(a.openEvent)c(document).on(a.openEvent,b.selector,function(a){!0!==e.options.onOpen.call(this,a,e)&&a.preventDefault()});
if(a.closeEvent)c(document).on(a.closeEvent,b.selector,function(a){!0!==e.options.onClose.call(this,a,e)&&a.preventDefault()});return e},open:function(b,a){var e=this,d=c.isArray(this.options.where)?this.options.where:[this.options.where];d.unshift(this.options.modal?c(this.options.parent):b.currentTarget);if(this.overlay&&(this.overlay.show(),"string"==typeof this.options.modal))this.overlay.one(this.options.modal,function(a){e.options.onClose(a,e)});"string"==typeof a?this.html(a):"function"==typeof a&&
a(b,e);this.stop(!0,!0).hide();return this[this.options.openEffect].apply(this,this.options.openEffectOptions).positionAt.apply(this,d)},close:function(){var b=this;this.overlay&&(b=b.add(this.overlay));b[this.options.closeEffect].apply(b,this.options.closeEffectOptions)}}})(jQuery);
